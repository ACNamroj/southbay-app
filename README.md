# Southbay App (sby-app)

Frontend web application built with Umi Max (@umijs/max), React, TypeScript, and Ant Design. It provides authenticated pages (login/forgot/reset password) and feature modules (Stores, People, Users, Segmentation) with a Pro Layout.

This document describes the stack, requirements, how to run/build, available scripts, environment variables, project structure, and licensing notes.

Last updated: 2025-12-02

## Overview

- Framework: Umi Max 4 (`@umijs/max`) with configuration in `.umirc.ts`
- Language: TypeScript
- UI: Ant Design 5 + Ant Design Pro Components
- Routing: Declared routes in `.umirc.ts` (no conventional routes)
- State/Models: Umi model plugin
- i18n: Umi locale plugin, default `es-ES`
- Mock API: Umi mock via `mock/` during development

## Requirements

- Node.js: 18+ recommended (Husky v9 requires Node 18+). TODO: Confirm exact minimum version used in deployment.
- Package manager: pnpm (lockfile present, and `.umirc.ts` sets `npmClient: 'pnpm'`)
- Git (for Husky hooks, optional)

## Getting Started

1. Install dependencies

```bash
pnpm install
```

2. Start the dev server

```bash
pnpm dev
# or
pnpm start
```

Umi will start the app on http://localhost:8000 (or the next available port).

3. Build for production

```bash
pnpm build
```

The production build is output to the `dist/` directory by Umi.

## Scripts

Defined in `package.json`:

- `dev`: Run the Umi dev server (`max dev`).
- `start`: Alias for `dev`.
- `build`: Build the app for production (`max build`).
- `setup` / `postinstall`: Run Umi setup tasks (`max setup`). Executed on install and can be invoked manually.
- `prepare`: Initialize Husky git hooks (`husky`).
- `format`: Run Prettier across the repository.

Run with pnpm, for example: `pnpm dev`, `pnpm build`, `pnpm format`.

## Environment Variables

- `BASE_URL`: Base URL for backend API requests.
  - Used in `src/services/client.ts`.
  - In development it is defined via Umi config: `.umirc.ts -> define: { 'process.env.BASE_URL': 'http://localhost:8080' }`.
  - For other environments, set a value at build time using Umi's `define` config or environment injection. TODO: Document the team-standard approach for staging/production builds (e.g., multiple config files, environment-specific pipelines, or runtime config mechanism if used).

Other common variables:

- `NODE_ENV`: Used for development checks in some services (e.g., `src/services/login/loginService.ts`).

## Entry Points and Routing

- Runtime/layout configuration: `src/app.tsx` (Umi runtime config: layout, request config, initial state).
- Routes: managed in `.umirc.ts` under the `routes` array (login, forgot/reset password, home, stores, people, users, segmentation).
- Page components live in `src/pages/**` and are referenced by the route config.

## Project Structure

Top-level (selected):

```
.
├─ .umirc.ts                 # Umi configuration (theme, plugins, routes, env vars, npmClient)
├─ index.ts                  # Exports app logos (for embedding/consumers)
├─ mock/                     # Umi mock API handlers (dev only)
├─ public/                   # Static assets served as-is (e.g., favicons under /icons)
├─ src/
│  ├─ app.tsx               # Umi runtime config (layout, request, initial state)
│  ├─ pages/                # Route pages (Login, ForgotPassword, ResetPassword, Home, Stores, People, Users, Segmentation)
│  ├─ layout/               # Layout components, menu utils, request interceptors
│  ├─ components/           # Reusable UI components
│  ├─ services/             # API client and domain services (auth, users, etc.)
│  ├─ models/               # Umi model files
│  ├─ locales/              # i18n resources (default es-ES)
│  ├─ utils/                # Utility functions (auth tokens, formatting, etc.)
│  ├─ assets/               # Logos and icons
│  └─ .umi/                 # Generated by Umi (do not edit)
├─ typings.d.ts              # Project typings
├─ tsconfig.json             # TypeScript configuration (extends from Umi-generated tsconfig)
├─ package.json              # Scripts and dependencies
├─ pnpm-lock.yaml            # pnpm lockfile
└─ README.md                 # This file
```

Notes:

- Ant Design theme is customized in `.umirc.ts` under `antd.theme.token`.
- Favicons configured via `.umirc.ts -> favicons` (served from `public/icons`).
- Access control, models, locale, and request plugins are enabled in `.umirc.ts`.

## Mock API

During development, Umi serves mock routes from the `mock/` directory. This allows UI development without a live backend. Remove or disable mocks as needed for integration testing.

## Testing

No test runner is currently configured in `package.json` and no test files were found in the repository.

TODO:

- Choose a test framework (e.g., Vitest/Jest + React Testing Library) and add scripts like `test`, `test:watch`, and `coverage`.
- Document how to run tests locally and in CI.

## Linting and Formatting

- Prettier is configured via scripts: `pnpm format` to format the codebase.
- `prettier-plugin-organize-imports` and `prettier-plugin-packagejson` are included.
- `lint-staged` is present as a dev dependency; TODO: Add/confirm `.lintstagedrc` (or package.json config) if pre-commit formatting is desired.
- Husky (`prepare` script) is included to enable Git hooks; TODO: Ensure hooks are installed (`pnpm husky install`) and any desired hooks are created.

## Deployment

- Build the production bundle with `pnpm build` (outputs to `dist/`).
- Serve the `dist/` directory with your preferred static hosting solution or reverse proxy.
- Environment configuration: ensure `BASE_URL` (and any other required values) are set appropriately at build time. TODO: Document the deployment process, hosting platform, and CI/CD steps used by the team.

## License

This project is licensed under the MIT License. See the `LICENSE` file for details.

## References

- Umi Max docs: https://umijs.org/docs/max/introduce
- Ant Design: https://ant.design/
- Ant Design Pro Components: https://procomponents.ant.design/
